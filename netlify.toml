[build]
command = "node scripts/netlify-write-firebase-service-account.mjs && node scripts/write-build-info.mjs && (npx tsx scripts/checkKBUpdates.ts 2>&1 || true) && npx next build && node -e \"try{require('fs').rmSync('.next/cache',{recursive:true,force:true})}catch(e){}\""
publish = ".next"

[build.environment]
NODE_VERSION = "20"

[[plugins]]
package = "@netlify/plugin-nextjs"

# Functions
# Important: do NOT include .env/.env.* files in deployed functions.
# The Next.js Runtime sometimes auto-adds them; this overrides to include only what we explicitly need.
[functions."*"]
  included_files = ["netlify/secrets/firebase-service-account.json"]
