@tailwind base;
@tailwind components;
@tailwind utilities;

/* Barletta Stamp Shadow font face - for hero text */
@font-face {
  font-family: 'BarlettaStamp';
  src: url('/fonts/Barletta Stamp Shadow.otf') format('opentype');
  font-weight: normal;
  font-style: normal;
  font-display: swap;
  font-feature-settings: normal;
  unicode-range: U+0000-10FFFF;
}

/* Barletta Inline font face - for navbar */
@font-face {
  font-family: 'BarlettaInline';
  src: url('/fonts/Barletta Inline.otf') format('opentype');
  font-weight: normal;
  font-style: normal;
  font-display: swap;
  font-feature-settings: normal;
  unicode-range: U+0000-10FFFF;
}

@layer utilities {
  /* Founders Grotesk (loaded in app/layout.tsx as CSS variable) */
  .font-founders {
    font-family: var(--font-founders), sans-serif;
  }

  /* Kudu mark masks (avoid inline styles in components) */
  .mask-kudu {
    mask-image: url("/images/Kudu.png");
    mask-size: contain;
    mask-repeat: no-repeat;
    mask-position: center;
    -webkit-mask-image: url("/images/Kudu.png");
    -webkit-mask-size: contain;
    -webkit-mask-repeat: no-repeat;
    -webkit-mask-position: center;
  }

  /* Category icon mask-image utilities (paired with .icon-primary-color) */
  .mask-icon-whitetail-breeder {
    mask-image: url("/images/whitetail breeder icon.png");
    -webkit-mask-image: url("/images/whitetail breeder icon.png");
  }
  .mask-icon-fallow {
    mask-image: url("/images/Fallow Icon.png");
    -webkit-mask-image: url("/images/Fallow Icon.png");
  }
  .mask-icon-bull {
    mask-image: url("/images/Bull Icon.png");
    -webkit-mask-image: url("/images/Bull Icon.png");
  }
  .mask-icon-tractor {
    mask-image: url("/images/Tractor Icon.png");
    -webkit-mask-image: url("/images/Tractor Icon.png");
  }
  .mask-icon-dog {
    mask-image: url("/images/Dog.png");
    -webkit-mask-image: url("/images/Dog.png");
  }
  .mask-icon-hunting-blind {
    mask-image: url("/images/Hunting blind.png");
    -webkit-mask-image: url("/images/Hunting blind.png");
  }
  .mask-icon-top-drive {
    mask-image: url("/images/Top Drive.png");
    -webkit-mask-image: url("/images/Top Drive.png");
  }

  /* Lightweight "prose" styles without adding tailwind-typography */
  .we-prose {
    font-family: var(--font-founders), sans-serif;
    font-size: 1rem;
    line-height: 1.75;
    color: hsl(var(--foreground));
  }
  .we-prose > * + * {
    margin-top: 1rem;
  }
  .we-prose h2 {
    margin-top: 2.2rem;
    font-size: 1.5rem;
    font-weight: 800;
    letter-spacing: -0.02em;
  }
  .we-prose h3 {
    margin-top: 1.8rem;
    font-size: 1.25rem;
    font-weight: 800;
    letter-spacing: -0.01em;
  }
  .we-prose a {
    color: hsl(var(--primary));
    text-decoration: underline;
    text-underline-offset: 4px;
    font-weight: 600;
  }
  .we-prose ul {
    list-style: disc;
    padding-left: 1.25rem;
  }
  .we-prose ol {
    list-style: decimal;
    padding-left: 1.25rem;
  }
  .we-prose li {
    margin-top: 0.35rem;
  }
  .we-prose blockquote {
    border-left: 3px solid hsl(var(--border));
    padding-left: 1rem;
    color: hsl(var(--muted-foreground));
  }
  .we-prose code {
    font-family: ui-monospace, SFMono-Regular, Menlo, Monaco, Consolas, "Liberation Mono", "Courier New", monospace;
    background: hsl(var(--muted));
    padding: 0.2rem 0.35rem;
    border-radius: 0.35rem;
    font-size: 0.95em;
  }
  .we-prose pre {
    overflow-x: auto;
    background: hsl(var(--muted));
    padding: 1rem;
    border-radius: 0.75rem;
  }
  .we-prose pre code {
    background: transparent;
    padding: 0;
  }

  /* Article polish: images, separators, stronger typographic rhythm */
  .we-prose-article img {
    border-radius: 1rem;
    border: 1px solid hsl(var(--border));
    box-shadow: 0 20px 60px hsl(var(--foreground) / 0.06);
  }
  .we-prose-article hr {
    border: 0;
    border-top: 1px solid hsl(var(--border));
    margin: 2rem 0;
  }
  .we-prose-article strong {
    font-weight: 800;
  }
  .we-prose-article h2::before {
    content: "";
    display: inline-block;
    width: 0.75rem;
    height: 0.75rem;
    border-radius: 999px;
    margin-right: 0.6rem;
    background: hsl(var(--primary));
    vertical-align: middle;
  }
}

@layer base {
  /* Light Theme - Sand Tonal Ramp (Darker, Richer) */
  :root {
    /* Canonical Color Tokens - Exact Hex Values as HSL */
    /* Sand-Base: #C7B79E, Sand-Surface: #E2D6C2, Sand-Subtle: #D6C8B0, Parchment: #F4F0E6 (highlight only), Olivewood: #22251F, Bark: #5B564A, Sage: #7F8A73 */
    
    /* Background = SAND-BASE (darker, uniform) */
    --background: 37 27% 70%;             /* #C7B79E - SAND-BASE */
    --foreground: 75 8% 13%;              /* #22251F - OLIVEWOOD (ink) */
    
    /* Surfaces = SAND-SURFACE (NOT parchment - lighter sand, still warm) */
    --card: 38 36% 82%;                  /* #E2D6C2 - SAND-SURFACE */
    --card-foreground: 75 8% 13%;         /* #22251F - OLIVEWOOD */
    
    --popover: 38 36% 82%;                /* #E2D6C2 - SAND-SURFACE */
    --popover-foreground: 75 8% 13%;      /* #22251F - OLIVEWOOD */
    
    --secondary: 38 32% 77%;             /* #D6C8B0 - SAND-SUBTLE */
    --secondary-foreground: 75 8% 13%;    /* #22251F - OLIVEWOOD */
    
    --muted: 38 30% 74%;                 /* Slightly lighter Sand-Subtle */
    --muted-foreground: 40 8% 42%;        /* Bark/soft ink for metadata */
    
    /* PRIMARY = SAGE (brand/action) */
    --primary: 90 12% 45%;               /* #7F8A73 - SAGE */
    --primary-foreground: 40 30% 93%;     /* #F4F0E6 - PARCHMENT (best contrast on Sage) */
    
    /* Accent = Olive green */
    --accent: 80 15% 55%;                /* Olive green for chips/hover/icons */
    --accent-foreground: 40 30% 93%;     /* #F4F0E6 - PARCHMENT (best contrast on olive) */
    
    --destructive: 0 65% 55%;             /* Muted red */
    --destructive-foreground: 40 30% 93%; /* #F4F0E6 - PARCHMENT */
    
    /* Border = Bark-derived, very subtle (low contrast) */
    --border: 40 8% 50%;                 /* Bark-derived, very subtle, warm */
    --input: 40 8% 50%;                  /* Same as border */
    --ring: 90 12% 45%;                  /* SAGE (focus ring) */
    
    --radius: 0.5rem;

    /* Motion tokens - single source of truth for animation timing */
    --motion-duration-fast: 150ms;
    --motion-duration-normal: 250ms;
    --motion-duration-slow: 350ms;
    --motion-ease-out: cubic-bezier(0.16, 1, 0.3, 1);
    --motion-ease-in-out: cubic-bezier(0.65, 0, 0.35, 1);
    
    /* Chart colors */
    --chart-1: 90 12% 45%;               /* Sage */
    --chart-2: 80 15% 70%;               /* Olive */
    --chart-3: 40 8% 32%;                /* Bark */
    --chart-4: 37 27% 70%;               /* Sand-Base */
    --chart-5: 75 8% 25%;                /* Darker olivewood */
    
    /* Parchment utility (micro-highlight only) */
    --parchment: 40 30% 93%;             /* #F4F0E6 - NOT for card backgrounds */

    /* Messaging: distinct surfaces so threads aren’t all one beige */
    --message-list: 38 32% 76%;         /* Slightly warmer sand strip */
    --message-received: 38 36% 85%;     /* Lighter surface for their bubbles */
    --message-sent: 90 12% 45%;         /* Sage (use with opacity in component) */
    --message-sent-border: 90 14% 38%;
    --message-input: 38 36% 82%;        /* Card-alike input bar */
  }
  
  /* Dark Theme - Olivewood Background, Olive Brand (unchanged - looks great) */
  .dark {
    /* Background = OLIVEWOOD (dark base) */
    --background: 75 8% 13%;             /* #22251F - OLIVEWOOD */
    --foreground: 40 30% 93%;            /* #F4F0E6 - PARCHMENT (light text) */
    
    /* Surfaces = Slightly lighter Olivewood-tint */
    --card: 75 8% 18%;                   /* Dark olive surface */
    --card-foreground: 40 30% 93%;       /* #F4F0E6 - PARCHMENT */
    
    --popover: 75 8% 18%;                /* Same as card */
    --popover-foreground: 40 30% 93%;    /* #F4F0E6 - PARCHMENT */
    
    --secondary: 75 8% 20%;             /* Slightly lighter than card */
    --secondary-foreground: 40 30% 93%; /* #F4F0E6 - PARCHMENT */
    
    --muted: 75 8% 16%;                 /* Deeper surface for subtle areas */
    --muted-foreground: 33 25% 65%;     /* Sand-tint / soft warm gray */
    
    /* PRIMARY = OLIVE (dark mode brand/action) */
    --primary: 80 15% 70%;              /* #B9C2A4 - OLIVE */
    --primary-foreground: 75 8% 13%;    /* #22251F - OLIVEWOOD (dark text on olive) */
    
    /* Accent = Olive */
    --accent: 80 15% 70%;               /* #B9C2A4 - OLIVE */
    --accent-foreground: 40 30% 93%;     /* #F4F0E6 - PARCHMENT */
    
    --destructive: 0 70% 55%;           /* Muted red */
    --destructive-foreground: 40 30% 93%; /* #F4F0E6 - PARCHMENT */
    
    /* Borders = Subtle dark (no bright outlines) */
    --border: 75 6% 25%;                /* Subtle dark border */
    --input: 75 6% 25%;                 /* Same as border */
    --ring: 80 15% 70%;                 /* #B9C2A4 - OLIVE (focus ring) */
    
    /* Chart colors for dark mode */
    --chart-1: 80 15% 70%;              /* Olive */
    --chart-2: 90 12% 50%;               /* Sage */
    --chart-3: 40 8% 40%;                /* Bark */
    --chart-4: 75 8% 18%;                /* Dark surface */
    --chart-5: 90 10% 45%;               /* Darker sage */

    /* Messaging: elevated surfaces, not too dark */
    --message-list: 75 8% 15%;          /* Slightly lighter than background */
    --message-received: 75 8% 21%;       /* Clear bubble surface */
    --message-sent: 80 15% 70%;          /* Olive (use with opacity) */
    --message-sent-border: 80 18% 55%;
    --message-input: 75 8% 18%;         /* Card-alike input bar */
  }
}

/* Phase 2A: Reduced motion — shorten our motion tokens when user prefers reduced motion */
@media (prefers-reduced-motion: reduce) {
  :root {
    --motion-duration-fast: 0.01ms;
    --motion-duration-normal: 0.01ms;
    --motion-duration-slow: 0.01ms;
  }
  /* Shorten Tailwind animation/transition utilities used by dialogs, accordions, etc. */
  [class*="animate-"],
  [class*="duration-"] {
    animation-duration: 0.01ms !important;
    transition-duration: 0.01ms !important;
  }
  html {
    scroll-behavior: auto !important;
  }
}

/* Make native date/time picker icons readable in dark mode (Chrome/Edge/Safari).
   This fixes the calendar icon on inputs like <input type="datetime-local" /> in the create-listing flow. */
.dark input[type="date"]::-webkit-calendar-picker-indicator,
.dark input[type="datetime-local"]::-webkit-calendar-picker-indicator,
.dark input[type="month"]::-webkit-calendar-picker-indicator,
.dark input[type="time"]::-webkit-calendar-picker-indicator,
.dark input[type="week"]::-webkit-calendar-picker-indicator {
  filter: invert(1) brightness(1.2);
  opacity: 0.95;
}

@layer base {
  * {
    @apply border-border;
  }
  body {
    @apply bg-background text-foreground;
    -webkit-font-smoothing: antialiased;
    -moz-osx-font-smoothing: grayscale;
    /* Prevent horizontal scroll on mobile */
    overflow-x: hidden;
  }
  /* Touch-friendly interactive elements */
  button, a, [role="button"], input[type="submit"], input[type="button"] {
    @apply min-h-[44px] min-w-[44px];
    touch-action: manipulation;
    -webkit-tap-highlight-color: transparent;
  }
  /* Typography scaling for mobile */
  h1 {
    @apply text-2xl md:text-3xl lg:text-4xl font-semibold leading-tight text-foreground;
  }
  h2 {
    @apply text-xl md:text-2xl lg:text-3xl font-semibold leading-tight text-foreground;
  }
  h3 {
    @apply text-lg md:text-xl lg:text-2xl font-semibold leading-tight text-foreground;
  }
  h4, h5, h6 {
    @apply font-semibold leading-tight text-foreground;
  }
  p {
    @apply leading-relaxed text-foreground text-sm md:text-base;
  }
  /* Form inputs - mobile optimized */
  input, textarea, select {
    @apply min-h-[48px] text-base;
    /* Prevent zoom on iOS */
    font-size: 16px;
  }
  @media (min-width: 768px) {
    input, textarea, select {
      font-size: inherit;
    }
  }
}

@layer utilities {
  .pb-safe {
    padding-bottom: env(safe-area-inset-bottom);
  }
  /* Use on pages that render the mobile BottomNav (h-16 + bottom padding) so content never sits under it on iOS. */
  .pb-bottom-nav-safe {
    padding-bottom: calc(5rem + max(env(safe-area-inset-bottom), 0.25rem));
  }
  .mb-bottom-nav {
    margin-bottom: 4rem;
  }
  @media (min-width: 768px) {
    .pb-bottom-nav-safe {
      padding-bottom: 0;
    }
    .mb-bottom-nav {
      margin-bottom: 0;
    }
  }

  .gradient-text {
    @apply text-foreground;
  }

  .gradient-text-muted {
    @apply bg-gradient-to-r from-foreground via-foreground/80 to-foreground/60 bg-clip-text text-transparent;
  }

  .glass {
    @apply bg-card/60 backdrop-blur-xl border border-border/50 shadow-warm;
  }

  /* Premium warm shadow - soft, long, atmospheric */
  .shadow-premium {
    box-shadow: 
      0 4px 12px -2px rgba(0, 0, 0, 0.08),
      0 2px 6px -2px rgba(0, 0, 0, 0.05),
      0 0 0 1px hsl(var(--border) / 0.12),
      0 24px 32px -8px rgba(0, 0, 0, 0.06),
      0 12px 16px -6px rgba(0, 0, 0, 0.03);
  }

  /* Warm shadow for cards - elevated sand surface */
  .shadow-warm {
    box-shadow: 
      0 3px 10px -2px rgba(0, 0, 0, 0.08),
      0 1px 4px -1px rgba(0, 0, 0, 0.05),
      0 0 0 1px hsl(var(--border) / 0.1);
  }

  /* Hover shadow - lifted paper effect */
  .shadow-lifted {
    box-shadow: 
      0 8px 20px -4px rgba(0, 0, 0, 0.1),
      0 4px 10px -2px rgba(0, 0, 0, 0.06),
      0 0 0 1px hsl(var(--border) / 0.15),
      0 32px 48px -12px rgba(0, 0, 0, 0.08),
      0 16px 24px -8px rgba(0, 0, 0, 0.04);
  }

  /* Parchment micro-highlight utilities (hairlines, underlines, glows only) */
  .parchment-hairline {
    border-color: hsl(40, 30%, 93% / 0.15);
  }
  .parchment-underline {
    border-bottom: 1px solid hsl(40, 30%, 93% / 0.2);
  }
  .parchment-glow {
    box-shadow: inset 0 1px 0 hsl(40, 30%, 93% / 0.1);
  }

  /**
   * Hide scrollbars until hover (clean appearance).
   * Apply to section-level scrollers (rails, panels, lists) where you don't want persistent bars.
   *
   * Notes:
   * - Touch devices have no hover → scrollbars remain hidden (still scrollable).
   * - Intentionally NOT global (do not affect page scrollbar).
   */
  .we-scrollbar-hover {
    scrollbar-width: none; /* Firefox */
    scrollbar-color: transparent transparent;
  }
  .we-scrollbar-hover::-webkit-scrollbar {
    width: 10px;
    height: 10px;
  }
  .we-scrollbar-hover::-webkit-scrollbar-track {
    background: transparent;
  }
  .we-scrollbar-hover::-webkit-scrollbar-thumb {
    background: transparent;
    border-radius: 9999px;
    border: 2px solid transparent;
    background-clip: content-box;
  }
  .we-scrollbar-hover:hover {
    scrollbar-width: thin; /* Firefox */
    scrollbar-color: hsl(var(--primary)) transparent;
  }
  .we-scrollbar-hover:hover::-webkit-scrollbar-thumb {
    background: hsl(var(--primary));
  }

  /* Inverted (subtle thumb) for dark sections e.g. browse header chip row; scrollbar on hover, blends with background */
  .we-scrollbar-hover-inverted {
    scrollbar-width: none;
    scrollbar-color: transparent transparent;
  }
  .we-scrollbar-hover-inverted::-webkit-scrollbar {
    width: 10px;
    height: 6px;
  }
  .we-scrollbar-hover-inverted::-webkit-scrollbar-track {
    background: transparent;
  }
  .we-scrollbar-hover-inverted::-webkit-scrollbar-thumb {
    background: transparent;
    border-radius: 9999px;
  }
  .we-scrollbar-hover-inverted:hover {
    scrollbar-width: thin;
    scrollbar-color: rgba(255, 255, 255, 0.18) transparent;
  }
  .we-scrollbar-hover-inverted:hover::-webkit-scrollbar-thumb {
    background: rgba(255, 255, 255, 0.18);
  }

  @keyframes shimmer {
    0% {
      background-position: -1000px 0;
    }
    100% {
      background-position: 1000px 0;
    }
  }

  .animate-shimmer {
    animation: shimmer 2s infinite;
    background: linear-gradient(
      to right,
      transparent 0%,
      rgba(255, 255, 255, 0.01) 50%,
      transparent 100%
    );
    background-size: 1000px 100%;
  }

  @keyframes float {
    0%, 100% {
      transform: translateY(0px);
    }
    50% {
      transform: translateY(-10px);
    }
  }

  .animate-float {
    animation: float 3s ease-in-out infinite;
  }
  
  /* Design system typography scale (Phase 1.1) */
  .we-h1 {
    @apply text-3xl md:text-4xl font-bold leading-tight text-foreground font-founders;
  }
  .we-h2 {
    @apply text-2xl md:text-3xl font-semibold leading-tight text-foreground font-founders;
  }
  .we-h3 {
    @apply text-xl md:text-2xl font-semibold leading-tight text-foreground font-founders;
  }
  .we-h4 {
    @apply text-lg md:text-xl font-semibold leading-tight text-foreground font-founders;
  }

  /* Spacing scale (Phase 1.2): tight / default / loose */
  .we-gap-tight { @apply gap-2; }
  .we-gap-default { @apply gap-4; }
  .we-gap-loose { @apply gap-6; }
  .we-space-y-tight { @apply space-y-2; }
  .we-space-y-default { @apply space-y-4; }
  .we-space-y-loose { @apply space-y-6; }
  .we-p-tight { @apply p-4; }
  .we-p-default { @apply p-6; }
  .we-p-loose { @apply p-8; }

  /* Force BarlettaStamp font to load and be used */
  .font-barletta {
    font-family: 'BarlettaStamp', serif !important;
    font-synthesis: none;
  }
  
  /* Force BarlettaInline font to load and be used */
  .font-barletta-inline {
    font-family: 'BarlettaInline', serif !important;
    font-synthesis: none;
  }
  
  /* Icon color filter - converts images to primary color using mask */
  .icon-primary-color {
    background-color: hsl(var(--primary));
    /* Provide shared mask positioning/sizing; actual mask-image comes from .mask-icon-* */
    mask-size: contain;
    mask-repeat: no-repeat;
    mask-position: center;
    -webkit-mask-size: contain;
    -webkit-mask-repeat: no-repeat;
    -webkit-mask-position: center;
  }

  /* Listing page: on mobile hide the server shell so only the interactive client shows (one back bar, one content; avoids duplicated top) */
  @media (max-width: 768px) {
    [data-listing-server-shell] {
      display: none !important;
    }
  }
}
